// nebula/js/h5_bridge.js
var ucVersion;try{ucVersion=navigator.userAgent.match(/UCBS\/(\d+\.\d+)/)}catch(error){console.err(error)}var isUC=ucVersion!=undefined;console.log("inject h5_bridge with isUC: "+isUC);if(!isUC){console.log("try inject androidEmbedViewManager script in non UC webview!");document.androidEmbedViewManager||(function(){var a={parseObjectElement:function(f){var j;var h;if(f.children){var k=f.children.length;for(var g=0;g<k;g++){var d=f.children[g];if(d.getAttribute("name")==="type"){j=d.getAttribute("value")}else{if(d.getAttribute("name")==="id"){h=d.getAttribute("value")}}}}if(h===undefined){h=f.id}var b=f.getBoundingClientRect();var e=0;if(document.documentElement&&document.documentElement.scrollLeft){e=document.documentElement.scrollLeft}else{if(document.body){e=document.body.scrollLeft}}var c=0;if(document.documentElement&&document.documentElement.scrollTop){c=document.documentElement.scrollTop}else{if(document.body){c=document.body.scrollTop}}return{elementId:h,type:j,x:b.left+e,y:b.top+c,width:b.width,height:b.height,}},render:function(c){var b=document.getElementById(c);if(b&&b.tagName==="OBJECT"){console.log("render "+c);return this.parseObjectElement(b)}},};document.androidEmbedViewManager=a})()}document.addNebulaDocumentFlag||(function(){console.log("begin load AlipayJSBridge");var h=window.__alipayConsole__||window.console,e=h.log;var i=function(j){e.call(h,"{bridge_token}h5container.message: "+JSON.stringify(j))};var d=null;var f=null;var a=function(j){e.call(h,"{bridge_token}h5container.postMessage: "+JSON.stringify(j.param));var k=b[j.clientId];if(k!==undefined){delete b[j.clientId];k({})}};window.addEventListener("message",function(j){if(j&&j.data==="__RENDER_WORKER_IPC_MP__"&&f===null&&j.ports&&j.ports.length===1){f=j.ports[0];f.onmessage=function(m){try{var n=JSON.parse(m.data);var l=n.handlerName==="postMessage"?"message":n.handlerName;if(n.responseId){var o=b[n.responseId];if(!(typeof n.keepCallback==="boolean"&&n.keepCallback)){delete b[n.responseId]}if("function"===typeof o){setTimeout(function(){o(n.responseData)},0)}}else{if(l){AlipayJSBridge.trigger(l,n,n.callbackId)}}}catch(k){e.call(h,"failed to process message: "+m.data);e.call(h,k)}};d=function(k){k["__FastPath__"]=1;var l=JSON.stringify(k);f.postMessage(l)}}});var b={};window.AlipayJSBridge={call:function(l,m,n){if("string"!==typeof l){return}if("function"===typeof m){n=m;m=null}else{if(typeof m!=="object"){m=null}}var k=""+new Date().getTime()+(Math.random());if("function"===typeof n){b[k]=n}var j={func:l,param:m,msgType:"call",clientId:k};if(l==="postMessage"){if(d!==null){d(j)}else{i(j)}}else{i(j)}},callback:function(k,l){var j={clientId:k,param:l};if(d!==null&&typeof k==="string"&&k.substring(0,7)!=="native_"){d(j)}else{i(j)}},trigger:function(o,p,j){if(o){var m=document.createEvent("Events");m.initEvent(o,!1,!0);m.syncJsApis=[];if(typeof p==="object"){for(var n in p){m[n]=p[n]}}m.clientId=j;var l=!document.dispatchEvent(m);if(j&&o==="back"){AlipayJSBridge.callback(j,{prevent:l})}if(j&&o==="closeWindow"){AlipayJSBridge.callback(j,{prevent:l})}if(j&&o==="firePullToRefresh"){AlipayJSBridge.callback(j,{prevent:l})}if(j&&o==="onShare"){AlipayJSBridge.callback(j,{prevent:l})}if(j&&o==="collectDestroyJsApi"){AlipayJSBridge.callback(j,{syncJsApis:m.syncJsApis})}if(j&&o==="pullIntercept"){AlipayJSBridge.callback(j,{prevent:l})}if(j&&o==="segControlClick"){AlipayJSBridge.callback(j,{prevent:l})}if(j&&o==="promotionClose"){AlipayJSBridge.callback(j,{prevent:l})}}},_invokeJS:function(k){k=JSON.parse(k);console.log("invokeJS msgType "+k.msgType+" func "+k.func);if(k.msgType==="callback"){var j=b[k.clientId];if(!(typeof k.keepCallback=="boolean"&&k.keepCallback)){delete b[k.clientId]}if("function"===typeof j){setTimeout(function(){j(k.param)},1)}}else{if(k.msgType==="call"){k.func&&this.trigger(k.func,k.param,k.clientId)}}},devPerformance4Test:""};document.addNebulaDocumentFlag={};AlipayJSBridge.startupParams="{startupParams}";window.POSTMESSAGE_FAST="{POSTMESSAGE_FAST}";window.APVIEWID="{APVIEWID}";var g=document.createEvent("Events");g.initEvent("AlipayJSBridgeReady",!1,!1);var c=document.addEventListener;document.addEventListener=function(j,k){if(j===g.type){setTimeout(function(){k(g)},1)}c.apply(document,arguments)};document.dispatchEvent(g);console.log("load AlipayJSBridge dispatchEvent AlipayJSBridgeReady")})();